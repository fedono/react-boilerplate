# React VS Vue

如何来做技术选型，为什么要使用这个库以及相应的生态

> 其实在问这个问题的时候，就需要了解 vue 和 react 的各种生态
>
> 比如 react 是没有官方路由，没有官方状态管理库的，context 是一种父级组件跨层级来传递数据，但并不是数据管理
>
> vue 就有官方的路由和状态管理，也就意味着，所有的基本的操作都能够非常的紧跟Vue，可以配套升级，react的升级还需要业界来同步更新，依赖方案更新没有那么的及时

> 看到一篇文章，说 react 是在实现某个模式，并尽量让 react 能够做的更好，如函数式编程，fiber ，
>
> vue 是一直在做如何和实践代码做耦合，如何让 vue 更好用，所以这时候会有 vue 官方的 路由，状态管理，动画库，这些 react 都没有官方的方案
>
> > 也就是 vue 是在做一套前端的解决方案，React 是在解决最核心的前端渲染的部分，其他的路由，状态管理都是社区来做的
>
> >  来源：你为什么选择React而不选择Vue？ - 金鹏大兄弟的回答 - 知乎 https://www.zhihu.com/question/294210442/answer/1992891881

> Vue 和 React 的优点分别是什么？ - 尤雨溪的回答 - 知乎 https://www.zhihu.com/question/301860721/answer/545031906



在参考 1 中可以看到，其实里面说的也有道理，就是react 能够做到的事情，Vue也能做到，那么我们能够考虑的事情就是什么？

> **核心要点**
>
> - 核心
>   - react  数据是保持 immutable ，vue 是mutable 的
>   - react 一直在探索方向，比如 vdom 比如 fiber 比如 hooks，vue 给人的感觉是一致在跟随，没有给前端届带来一些新的风向，但是与业务一直贴合的比较紧密
>     - 知乎 尤雨溪 答过一个问题，说之前 vue 引入了react 的一个方案，但是在 vue 中的效果不好，所以舍弃了，好像是 fiber 的方案?
>
> - 生态	
>   - react 强于 vue，这个在 vue 中的官方文档还是 尤雨溪在知乎答题中有写，现在大致是2:1 的关系
> - 状态管理
>   - react 是社区驱动，没有统一的方案，vue 有官方的方案
>   - 所以同步升级与兼容性，vue 当然更好
> - 渲染更新
>   - react 通过 setState 来了解更新，从 willUpdate 来判断是否更新，vue 通过直接修改data 就能够更新，并且还有 computed 和 watch 来进行监听
> - 版本升级
>   - react 是渐进式的升级，不会出现升级一个版本就不能用，所以在升级之前可以不断的重构之前的代码，也可以使用新特性的时候保持旧代码不变，vue 大版本升级底层会进行更改，升级会需要重构整个应用
>
> **次级要点**
>
> - 维护
>   - 大厂维护 VS 个人维护（当然vue 现在也是团队了，主要是尤雨溪作为leader 
>     - 看代码的贡献比，vue 中尤雨溪的代码贡献比其他所有人都多，虽然 vue 是一个团队，但是尤雨溪是绝对的核心，和 React 的代码贡献比例不一样
>   - react 支持的 Facebook 自己公司的业务，同样也会遇到是先解决公司内业务的问题还是社区的问题的优先级，但是vue 就肯定是解决社区的问题，不会有这种
>     - 解决社区的问题好像在 react 的 issues 中有写，好像是 svg 的问题，因为在 facebook 中好像没有这种需求
>     - 这个好像 cat chen 写过 Facebook 中招人后遇到了这个问题，因为在解决公司内的问题还是社区的问题没有达成一致
> - 协议
>   - Facebook 之前更改的协议事件可能会引发风险，vue 没有这种问题
> - 上手程度
>   - vue 更容易上手，所以在人员流动性高的时候，使用 vue 好一点



1. 生态
    目前哪个的生态好一点，生态好一点就意味着开发者的工作量可以少很多，但是现在 Vue 和 react 都差不多

  > 怎么可能是差不多，Vue 生态上和react 的差异，Vue官方都是承认的

2. 维护
    目前哪个的维护性好一点，Vue 更简单，那么可维护性就好一点，如果某个框架不再更新了，那么接下来就需要自己来做维护
    框架内部出现的问题，就都需要来通过我们来解决，这就必须要我们非常熟悉某一个框架的内部设计，所以这个也是技术选型的一个要点

3. 协议
    react 闹出的协议事件，导致厂商害怕被维权，所以导致了需要后续维护的一个关键点

4. 上手状态
    Vue 确实是更容易上手，但是为什么现在非常多的大厂，选择的都是 react 呢？理由是什么？
    在 参考2 中有看到一个观点， vue 的上手比较容易，那么在人员流动比较大的时候，Vue 肯定会好一点
> 我觉得现在市场已经形成了对这三大框架的认知共性了：
> 
> - Angular适合较复杂的SPA应用，比如工具类的应用就比较适合，Angular属于大型框架，各个模块比较完整，提供的工具、扩展也比较丰富，适合沉淀大型项目，但上手成本高。楼上有人说不知道哪天变成dart，我觉得Google的技术人员不会这么任性吧，而且三大框架中谷歌背景的感觉最踏实。
> - React适合对性能要求较高，且兼容移动端的产品，RN之类的应用还是比较广泛，移动端使用较多吧，会的人也多，上手不算太复杂，但学习曲线陡峭，得有好的架构师带领。
> - Vue适合增删改查类的管理系统，H5内嵌页、小程序之类的，这种应用改动频繁，人员流动性可能较大，上手容易，综合成本较低。

5.  组件内状态管理

   > 这个来自参考 4，

   Vue使用的是数据对象（数据），反应使用的是状态对象（不可变状态），这点两个框架的设计不同，如下的问题解决思路也不同。
   
   1. 我如何修改数据？Vue直接将此引用数据对象，直接修改。React使用setState方法修改
   2. 框架如何发现数据被修改？Vue使用es5新方法Object.defineProperty，劫持setter，getter实现数据监听。React，你用了setState，它通过这个函数就知道一些数据变化了。
   3. 我如何发现数据被修改？Vue：使用观察者，或者计算属性发现反应：componentWillUpdate，componentDidUpdate中可以监听变化，或者函数组件的依赖部分插入
   4. 框架何时渲染修改的数据，我如何知道已经渲染好了？Vue：在适当的时候渲染，你通过使用watcher，或者计算属性发现反应：setState调用后在适当的时候重新渲染，并调用相关生命周期钩子
   
6.  触发更新

    1.  Vue 只要修改了 data 就会触发更新

        在 Vue 应用中，组件的依赖是在渲染过程中自动追踪的，所以系统能精确知晓哪个组件确实需要被重渲染。

    2.  react 可以选择哪些 props/state 改变了才更新

    基于这两点，是不是觉得 react 好一点，毕竟在大型应用的时候，还是自己决定会好一点 

    > 为什么在大型应用的时候，选择 react 会好一点？还是应该更深入一点来聊这个
    
    > react 中如果父级组件更新了一个对象的 props，那么所有的子组件都会重新渲染，因为对象数据改变了，react 中比对都是props 是否全等，所以需要手动去比对
    >
    > 但是 vue 中是自动追踪的，这个自动是不是会比对前后两个对象中某个值是否全等，如果对象中有的值仍然相等，就使用之前对象的值，这样就不会导致组件重新渲染？
    
7.  版本升级

    React 的版本更新都是渐进式的更新，就不会存在一个版本更新导致之前的语法不能用，不存在一个大版本更新，要让用户重新学习很多东西

    比如React  比较重要的更新，fiber 的引入，hooks 的引入，都是可以更新 react 版本之后，然后就可以使用，然后不影响旧的业务代码

    vue 存在 2 / 3 这种大版本的更新，更新之后，基本的语法有变更，感觉需要对整个业务进行一次重新的技术改版，2 / 3 的代码存在很大型的不兼容
    
7.  this 指针

    react 中的类组件需要绑定 this，函数组件不需要

    vue 中有大量的方法和第三方的库都是绑定在 this 中，如果代码量大，维护起来就会非常麻烦

    > 当项目多人协作的时候，或者承接某某祖传代码，你不全局搜索，你都不知道 this 上面挂了羊头还是狗肉。
    >
    > - this.ajax
    > - this.http
    > - this.message
    > - this.wtf......
    >
    > 为了避免以后和其他插件冲突，插件一般都会单独命名前缀，使用都是：
    >
    > - this.$su_message
    > - this.$su_modal
    > - this.$su_toast
    >
    > 来自 [为什么我们放弃了Vue？Vue和React深度比较](https://markdowner.net/article/79319258450055168)
    
    
    
9. SSR 都支持 

10. typescript 

    react 都支持，vue2 不好写 ts ，vue3 好一点

    主要是 vue 不太适合在 view 中写

## React 的优劣

### React 自身特性

- react 新增的 useEffect 相对于 componentDidMount 有什么优势

  - react  的 useEffect 是可以写多个的，但是 componentDidMount 是只能写一个

    - useEffect 可以根据不同的依赖项写多个，颗粒度更细，逻辑更好区分，可阅读性更好

  - 那么 useEffect 中是可以通过依赖来精确控制当前内部的函数是否运行，这部分 react 已经帮我们做好了

    也就是useEffect 有多个逻辑，那么我们可以精确控制那部分逻辑在什么时候渲染

  
  - 如果是 class 组件，就需要在 didMount 中，我们自己来比对依赖是否发生了变化，然后再 didMount 使用分支的操作来控制哪些逻辑运行 
  
  - useEffect 的返回就是组件 Unmount 的时候触发的，这个在类组件中需要在DidMount 和 UnMount 中写
  
  

## Vue 的优劣

### 优势

- 易上手，文档写得好，有中文文档

  - 不用去理会函数组件、类组件和pure component 的概念

- 直接修改数据，不用使用 setState，不用关心同步异步，不行就加 nextTick

  - computed 和 watch 概念比较直观

- 有模板，和写HTML差不多，CSS 、 JS、模板都写在同一个文件里面，（是优点也是缺点

- 有一系列集成的解决方案，路由，状态管理，不用思考直接就可以使用

  - vuex 设计的好，react 的状态管理很多设计也是，有 state / reduce/effects 这三类的

- 性能好，不需要开发者来决定是否更新，框架内部就能自动监听

  - 有静态节点标记
  - 有lru 的节点缓存

- 源码比较好读，不像react那样生涩，所以开源的方案不少，如 mpvue 和 uniapp 这些通过魔改 vue 来实现一些具体场景的解决方案

  > 说这个的时候，肯定会问到你读了哪些源码

### 缺点

- 上下文丢失

  Vue 的单文件组件，使用 `<template>` 、`<script>` 对代码进行分割，直接导致的问题就是上下文丢失。 举个例子，你封装了一些常用的函数，在 Vue 文件中 import 进来。你这个函数能在 template 中直接使用吗？

  需要将方法定义在methods中，再引用进来。模板语法并不知道你有 isNickname 这个函数，简单的操作多了 3 行代码。

  >  来自 [为什么我们放弃了Vue？Vue和React深度比较](https://markdowner.net/article/79319258450055168)

- 状态管理库强绑定

  vuex 和 vue 是强绑定的，但是 react 中的状态管理库都不是，redux 是可以在 vue 中使用的，需要中间的 react-redux 库

  react 中有 redux-saga / redux-observable 来处理竞态问题，但是 vue 没有

- 代码迁移复杂度更高

  vue 的代码迁移，功能整和，需要把代码放到对应的 methods 这种，react 可以单独抽离出文件，对应的组件直接调用就可以



每年的 state of js 的数据也可以作为 react vs vue 的依据质疑

## 参考
- [谈，前端框架的『御剑之道』](https://github.com/berwin/Blog/issues/26)

- [在架构前端项目时，关于技术选型，应该怎么从vue、react、Angular选择](https://segmentfault.com/q/1010000015741680)

- [React 还是 Vue：选哪个？](https://www.infoq.cn/article/vxmggwtukgtkoemswtqa) 

  这个还是好一点的
  
- [为什么我们放弃了Vue？Vue和React深度比较](https://markdowner.net/article/79319258450055168)

  这个也好，这里面比较了非常多的要点，是非常好的，在做架构的时候，本身就需要考虑非常多的要点

  这个应该是我目前看到最好的一篇了，内容详实

- [前端框架及组件库选型分析](https://www.daimajiaoliu.com/daima/479986699100402) 
